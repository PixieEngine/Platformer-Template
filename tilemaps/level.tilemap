{"width":20,"height":15,"tileWidth":32,"tileHeight":32,"title":"","entityCache":{"block":{"name":"Unnamed Entity","width":32,"height":32,"sprite":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAMUlEQVRYR+3QwQ0AAAgCMdh/aHULPyW5P2mTzPW2OkCAAAECBAgQIECAAAECBAh8CyywJyABJlvz9gAAAABJRU5ErkJggg==","solid":true,"uuid":"block"},"player":{"name":"Unnamed Entity","width":32,"height":32,"class":"Player","__CODE":"self.include Debuggable\n\nself.debug\n  filter: 'changed'\n  velocity: false\n  bounds: false\n  x: 35\n  y: 35\n  \nphysics =\n  acceleration:\n    x: 1\n    y: 3\n  jumpPower: -20\n  velocity:\n    xMin: -6\n    xMax: 6\n    yMin: -13\n    yMax: 10\n\nphysics.jumpGravity = physics.acceleration.y * 0.3\n\nphysics.friction = physics.velocity.xMax / (physics.velocity.xMax + physics.acceleration.x)\nphysics.minSpeed = physics.acceleration.x * physics.friction\n\nself.bind 'update', ->\n  self.playerInput()\n  \n  vel = I.velocity\n  \n  self.applyGravity(vel)\n  self.resolveCollisions(vel)\n\n  I.hflip = I.facing.x < 0 \n    \n  vel.x = vel.x * physics.friction\n      \n  self.clampVelocity(vel)\n  \nself.extend\n  applyGravity: (velocity) ->\n    if I.jumping\n      velocity.y += physics.jumpGravity\n    else\n      velocity.y += physics.acceleration.y\n      \n  clampVelocity: (velocity) ->\n    velocity.x = velocity.x.clamp(physics.velocity.xMin, physics.velocity.xMax)\n    velocity.y = velocity.y.clamp(physics.velocity.yMin, physics.velocity.yMax) \n    \n    velocity.x = 0 if velocity.x.abs() < physics.minSpeed\n\n  collide: (xOffset, yOffset, className) ->\n    engine.find(className).inject false, (hit, block) ->\n      hit || Collision.rectangular(self.bounds(xOffset, yOffset), block.bounds())\n\n  jump: ->\n    I.jumping = true\n    I.landed = false\n    I.velocity.y = physics.jumpPower     \n      \n  playerInput: ->\n    if keydown.left\n      I.velocity.x -= physics.acceleration.x\n  \n      I.facing = Point(-1, 0)\n    else if keydown.right\n      I.velocity.x += physics.acceleration.x\n     \n      I.facing = Point(1, 0)\n    else\n      I.velocity.x = I.velocity.x.approach(0, physics.acceleration.x)\n      \n    if justPressed.z and I.landed    \n      self.jump()\n      \n    I.jumping = false unless keydown.z\n      \n  resolveCollisions: (velocity) ->\n    xSign = velocity.x.sign()\n    ySign = velocity.y.sign()\n    \n    velocity.x.abs().times ->\n      if self.collide(xSign, 0, \".solid\")\n        velocity.x = 0\n      else\n        I.x += xSign\n\n    velocity.y.abs().times ->   \n      if self.collide(0, ySign, \".solid\")                  \n        velocity.y = 0\n        I.landed = true\n      else\n        I.y += ySign       ","uuid":"player","facing":"Point(1, 0)","jumping":false,"landed":true,"onWall":false,"velocity":"{x: 0, y: 0}","sprite":"raptor"},"background":{"name":"Unnamed Entity","width":32,"height":32,"class":"Background","sprite":"background","__CODE":"self.unbind 'draw'\nself.bind 'draw', (canvas) ->\n  I.sprite.fill(canvas, -16, -16, App.width, App.height)","uuid":"background"}},"layers":[{"name":"Background","instances":[{"uuid":"background","x":0,"y":0,"properties":{}}]},{"name":"Entities","instances":[{"uuid":"block","x":0,"y":0,"properties":{}},{"uuid":"block","x":0,"y":32,"properties":{}},{"uuid":"block","x":0,"y":64,"properties":{}},{"uuid":"block","x":0,"y":96,"properties":{}},{"uuid":"block","x":0,"y":128,"properties":{}},{"uuid":"block","x":0,"y":160,"properties":{}},{"uuid":"block","x":0,"y":192,"properties":{}},{"uuid":"block","x":0,"y":224,"properties":{}},{"uuid":"block","x":0,"y":416,"properties":{}},{"uuid":"block","x":0,"y":384,"properties":{}},{"uuid":"block","x":0,"y":352,"properties":{}},{"uuid":"block","x":0,"y":320,"properties":{}},{"uuid":"block","x":0,"y":288,"properties":{}},{"uuid":"block","x":0,"y":256,"properties":{}},{"uuid":"block","x":32,"y":0,"properties":{}},{"uuid":"block","x":64,"y":0,"properties":{}},{"uuid":"block","x":96,"y":0,"properties":{}},{"uuid":"block","x":128,"y":0,"properties":{}},{"uuid":"block","x":192,"y":0,"properties":{}},{"uuid":"block","x":224,"y":0,"properties":{}},{"uuid":"block","x":256,"y":0,"properties":{}},{"uuid":"block","x":288,"y":0,"properties":{}},{"uuid":"block","x":320,"y":0,"properties":{}},{"uuid":"block","x":352,"y":0,"properties":{}},{"uuid":"block","x":384,"y":0,"properties":{}},{"uuid":"block","x":416,"y":0,"properties":{}},{"uuid":"block","x":448,"y":0,"properties":{}},{"uuid":"block","x":480,"y":0,"properties":{}},{"uuid":"block","x":512,"y":0,"properties":{}},{"uuid":"block","x":544,"y":0,"properties":{}},{"uuid":"block","x":576,"y":0,"properties":{}},{"uuid":"block","x":608,"y":0,"properties":{}},{"uuid":"block","x":160,"y":0,"properties":{}},{"uuid":"block","x":0,"y":448,"properties":{}},{"uuid":"block","x":32,"y":448,"properties":{}},{"uuid":"block","x":64,"y":448,"properties":{}},{"uuid":"block","x":96,"y":448,"properties":{}},{"uuid":"block","x":128,"y":448,"properties":{}},{"uuid":"block","x":160,"y":448,"properties":{}},{"uuid":"block","x":192,"y":448,"properties":{}},{"uuid":"block","x":224,"y":448,"properties":{}},{"uuid":"block","x":256,"y":448,"properties":{}},{"uuid":"block","x":288,"y":448,"properties":{}},{"uuid":"block","x":320,"y":448,"properties":{}},{"uuid":"block","x":352,"y":448,"properties":{}},{"uuid":"block","x":384,"y":448,"properties":{}},{"uuid":"block","x":416,"y":448,"properties":{}},{"uuid":"block","x":448,"y":448,"properties":{}},{"uuid":"block","x":480,"y":448,"properties":{}},{"uuid":"block","x":512,"y":448,"properties":{}},{"uuid":"block","x":544,"y":448,"properties":{}},{"uuid":"block","x":576,"y":448,"properties":{}},{"uuid":"block","x":608,"y":448,"properties":{}},{"uuid":"block","x":608,"y":32,"properties":{}},{"uuid":"block","x":608,"y":64,"properties":{}},{"uuid":"block","x":608,"y":96,"properties":{}},{"uuid":"block","x":608,"y":128,"properties":{}},{"uuid":"block","x":608,"y":160,"properties":{}},{"uuid":"block","x":608,"y":192,"properties":{}},{"uuid":"block","x":608,"y":224,"properties":{}},{"uuid":"block","x":608,"y":256,"properties":{}},{"uuid":"block","x":608,"y":288,"properties":{}},{"uuid":"block","x":608,"y":320,"properties":{}},{"uuid":"block","x":608,"y":352,"properties":{}},{"uuid":"block","x":608,"y":384,"properties":{}},{"uuid":"block","x":608,"y":416,"properties":{}},{"uuid":"block","x":160,"y":288,"properties":{}},{"uuid":"block","x":192,"y":288,"properties":{}},{"uuid":"block","x":224,"y":288,"properties":{}},{"uuid":"block","x":256,"y":288,"properties":{}},{"uuid":"block","x":256,"y":256,"properties":{}},{"uuid":"block","x":256,"y":224,"properties":{}},{"uuid":"block","x":256,"y":192,"properties":{}},{"uuid":"block","x":288,"y":192,"properties":{}},{"uuid":"block","x":320,"y":192,"properties":{}},{"uuid":"block","x":352,"y":192,"properties":{}},{"uuid":"block","x":384,"y":192,"properties":{}},{"uuid":"player","x":160,"y":256,"properties":{}},{"uuid":"block","x":32,"y":352,"properties":{}},{"uuid":"block","x":64,"y":352,"properties":{}}]}],"orientation":"orthogonal"}